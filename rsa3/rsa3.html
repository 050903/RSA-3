<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° T∆∞∆°ng T√°c Thu·∫≠t To√°n RSA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Visualization & Content Choices:
    - Report Info: RSA process (key gen, encrypt, decrypt). -> Goal: Demonstrate the full algorithm flow interactively. -> Viz/Method: A multi-step interactive form (the "RSA Simulator") built with HTML and JS (using BigInt for calculations). -> Interaction: User inputs p, q, e, and a message. The application calculates n, phi(n), d, ciphertext, and decrypted text in sequence. "Load Example" buttons pre-fill data from the report's exercises. Detailed step-by-step solutions for each problem are now displayed in a dedicated area when an example is loaded. -> Justification: This provides a hands-on learning experience that is far more effective than static text, augmented by immediate access to the full solution breakdown. -> Library: Vanilla JS.
    - Report Info: Mathematical concepts (Euler's Totient, Modular Inverse). -> Goal: Explain the building blocks of RSA. -> Viz/Method: Small, dedicated interactive calculators for each concept within the "Mathematical Foundations" section. -> Interaction: Users input numbers and see the results calculated instantly. -> Justification: Breaks down complex math into manageable, verifiable pieces. -> Library: Vanilla JS.
    - Report Info: Security concepts (Key Length). -> Goal: Illustrate the relationship between key size and security. -> Viz/Method: A bar chart showing different key lengths (1024, 2048, 4096) and their corresponding security status (e.g., "Vulnerable", "Secure", "More Secure"). -> Interaction: Static chart for clear visual comparison. -> Justification: A chart is more impactful than text for comparing quantitative data. -> Library: Chart.js.
    - Report Info: Abstract concepts (Padding, Process diagrams). -> Goal: Visualize abstract structures. -> Viz/Method: Diagrams constructed using styled HTML/Tailwind divs, borders, and flexbox. -> Interaction: Static diagrams for clear illustration. -> Justification: Avoids external images and libraries (like SVG/Mermaid) while still providing clear visual aids. -> Library: Tailwind CSS.
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .section-card {
            background-color: #FFFFFF;
            border: 1px solid #F0EAE1;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            transition: box-shadow 0.3s ease-in-out;
        }
        .section-card:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
        }
        .sticky-nav {
            position: sticky;
            top: 0;
            z-index: 50;
            background-color: rgba(253, 251, 248, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .nav-link {
            transition: color 0.3s, border-color 0.3s;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #2563EB;
            border-bottom-color: #2563EB;
        }
        .input-field {
            border: 1px solid #D1D5DB;
            background-color: #F9FAFB;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .input-field:focus {
            outline: none;
            border-color: #2563EB;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4);
        }
        .btn {
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.1s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .btn-primary {
            background-color: #2563EB;
            color: white;
        }
        .btn-primary:hover {
            background-color: #1D4ED8;
        }
        .btn:active {
            transform: scale(0.98);
        }
        .output-box {
            background-color: #F3F4F6;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: 'Courier New', Courier, monospace;
            word-wrap: break-word;
            border: 1px solid #E5E7EB;
        }
        h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 1.5rem;
        }
        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1F2937;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 9999px;
            background-color: #DBEAFE;
            color: #1E40AF;
            font-weight: 700;
            font-size: 1.125rem;
            margin-right: 1rem;
            flex-shrink: 0;
        }
        .solution-details {
            background-color: #FDFBF8;
            border: 1px solid #E0E0E0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .solution-details h3 {
            font-size: 1.3rem;
            color: #2563EB;
            margin-bottom: 1rem;
        }
        .solution-details h4 {
            font-size: 1.1rem;
            color: #1D4ED8;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .solution-details ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        .solution-details ul li {
            margin-bottom: 0.5rem;
        }
        .solution-details p {
            margin-bottom: 0.75rem;
        }
    </style>
</head>
<body class="antialiased">

    <header class="text-center py-10 bg-white border-b border-gray-200">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800">Kh√°m Ph√° T∆∞∆°ng T√°c Thu·∫≠t To√°n RSA</h1>
        <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">M·ªôt c√¥ng c·ª• tr·ª±c quan ƒë·ªÉ t√¨m hi·ªÉu c√°ch ho·∫°t ƒë·ªông c·ªßa m·ªôt trong nh·ªØng thu·∫≠t to√°n m√£ h√≥a n·ªÅn t·∫£ng nh·∫•t th·∫ø gi·ªõi.</p>
    </header>

    <nav class="sticky-nav shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-center h-16">
                <div class="flex space-x-8">
                    <a href="#overview" class="nav-link inline-flex items-center px-1 pt-1 text-sm font-medium">T·ªïng Quan</a>
                    <a href="#math-foundations" class="nav-link inline-flex items-center px-1 pt-1 text-sm font-medium">N·ªÅn T·∫£ng To√°n H·ªçc</a>
                    <a href="#simulator" class="nav-link inline-flex items-center px-1 pt-1 text-sm font-medium">M√¥ Ph·ªèng RSA</a>
                    <a href="#advanced" class="nav-link inline-flex items-center px-1 pt-1 text-sm font-medium">N√¢ng Cao & B·∫£o M·∫≠t</a>
                    <a href="#applications" class="nav-link inline-flex items-center px-1 pt-1 text-sm font-medium">·ª®ng D·ª•ng</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <section id="overview" class="section-card">
            <h2>üìú T·ªïng Quan v·ªÅ RSA</h2>
            <p class="text-gray-600 mb-6">RSA (vi·∫øt t·∫Øt c·ªßa Rivest-Shamir-Adleman) l√† m·ªôt thu·∫≠t to√°n m√£ h√≥a kh√≥a c√¥ng khai v√† l√† n·ªÅn t·∫£ng cho vi·ªác truy·ªÅn d·ªØ li·ªáu an to√†n. ƒêi·ªÉm ƒë·∫∑c bi·ªát c·ªßa n√≥ l√† s·ª≠ d·ª•ng m·ªôt c·∫∑p kh√≥a: m·ªôt <strong>kh√≥a c√¥ng khai</strong> ƒë·ªÉ m√£ h√≥a tin nh·∫Øn (c√≥ th·ªÉ chia s·∫ª cho m·ªçi ng∆∞·ªùi) v√† m·ªôt <strong>kh√≥a ri√™ng t∆∞</strong> ƒë·ªÉ gi·∫£i m√£ n√≥ (ch·ªâ ng∆∞·ªùi nh·∫≠n m·ªõi bi·∫øt). S·ª©c m·∫°nh c·ªßa RSA n·∫±m ·ªü ch·ªó vi·ªác t√¨m ra kh√≥a ri√™ng t∆∞ t·ª´ kh√≥a c√¥ng khai l√† c·ª±c k·ª≥ kh√≥ khƒÉn v·ªÅ m·∫∑t t√≠nh to√°n.</p>
            <div class="border border-gray-200 rounded-lg p-6 bg-gray-50">
                <h3 class="text-center">Lu·ªìng Ho·∫°t ƒê·ªông C∆° B·∫£n</h3>
                <div class="mt-4 flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4">
                    <div class="text-center">
                        <div class="p-4 bg-blue-100 text-blue-800 rounded-lg">Tin nh·∫Øn g·ªëc</div>
                        <div class="font-mono mt-1 text-sm">"STOP"</div>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="text-center">
                        <div class="p-4 bg-green-100 text-green-800 rounded-lg">M√£ H√≥a<br><span class="text-xs font-mono">(Kh√≥a C√¥ng Khai)</span></div>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="text-center">
                        <div class="p-4 bg-red-100 text-red-800 rounded-lg">B·∫£n m√£</div>
                        <div class="font-mono mt-1 text-sm">"2081..."</div>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="text-center">
                        <div class="p-4 bg-purple-100 text-purple-800 rounded-lg">Gi·∫£i M√£<br><span class="text-xs font-mono">(Kh√≥a Ri√™ng T∆∞)</span></div>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="text-center">
                        <div class="p-4 bg-blue-100 text-blue-800 rounded-lg">Tin nh·∫Øn g·ªëc</div>
                        <div class="font-mono mt-1 text-sm">"STOP"</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="math-foundations" class="section-card">
            <h2>üßÆ N·ªÅn T·∫£ng To√°n H·ªçc</h2>
            <p class="text-gray-600 mb-6">RSA ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n m·ªôt v√†i kh√°i ni·ªám c·ªët l√µi t·ª´ l√Ω thuy·∫øt s·ªë. Vi·ªác hi·ªÉu c√°c kh√°i ni·ªám n√†y s·∫Ω gi√∫p b·∫°n n·∫Øm b·∫Øt ƒë∆∞·ª£c t·∫°i sao RSA l·∫°i an to√†n v√† ƒë√°ng tin c·∫≠y. H√£y th·ª≠ c√°c c√¥ng c·ª• t√≠nh to√°n nh·ªè d∆∞·ªõi ƒë√¢y ƒë·ªÉ kh√°m ph√° ch√∫ng.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3>H√†m s·ªë Euler's Totient (œÜ(n))</h3>
                    <p class="text-sm text-gray-500 mb-4">H√†m n√†y ƒë·∫øm c√°c s·ªë nguy√™n d∆∞∆°ng nh·ªè h∆°n `n` v√† nguy√™n t·ªë c√πng nhau v·ªõi `n`. V·ªõi `n = p * q` (p, q l√† s·ªë nguy√™n t·ªë), c√¥ng th·ª©c l√† `œÜ(n) = (p - 1) * (q - 1)`.</p>
                    <div class="space-y-4">
                        <input id="phi_p" type="number" placeholder="Nh·∫≠p s·ªë nguy√™n t·ªë p" class="input-field">
                        <input id="phi_q" type="number" placeholder="Nh·∫≠p s·ªë nguy√™n t·ªë q" class="input-field">
                        <button id="calc_phi" class="btn btn-primary w-full">T√≠nh œÜ(n)</button>
                        <div id="phi_result" class="output-box h-12"></div>
                    </div>
                </div>
                <div>
                    <h3>Ngh·ªãch ƒê·∫£o Nh√¢n M√¥-ƒëun</h3>
                    <p class="text-sm text-gray-500 mb-4">Trong RSA, kh√≥a ri√™ng t∆∞ `d` l√† ngh·ªãch ƒë·∫£o nh√¢n m√¥-ƒëun c·ªßa kh√≥a c√¥ng khai `e` theo m√¥-ƒëun `œÜ(n)`. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† `(e * d) mod œÜ(n) = 1`.</p>
                    <div class="space-y-4">
                        <input id="mod_inv_e" type="number" placeholder="Nh·∫≠p s·ªë m≈© c√¥ng khai e" class="input-field">
                        <input id="mod_inv_phi" type="number" placeholder="Nh·∫≠p gi√° tr·ªã œÜ(n)" class="input-field">
                        <button id="calc_mod_inv" class="btn btn-primary w-full">T√≠nh d</button>
                        <div id="mod_inv_result" class="output-box h-12"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="simulator" class="section-card">
            <h2>‚öôÔ∏è M√¥ Ph·ªèng RSA T·ª´ng B∆∞·ªõc</h2>
            <p class="text-gray-600 mb-6">ƒê√¢y l√† n∆°i b·∫°n c√≥ th·ªÉ th·ª±c h√†nh to√†n b·ªô quy tr√¨nh RSA. H√£y nh·∫≠p c√°c gi√° tr·ªã c·ªßa ri√™ng b·∫°n ho·∫∑c t·∫£i c√°c v√≠ d·ª• t·ª´ b√†i t·∫≠p ƒë·ªÉ xem c√°ch ch√∫ng ho·∫°t ƒë·ªông. L∆∞u √Ω: Thu·∫≠t to√°n n√†y ho·∫°t ƒë·ªông v·ªõi c√°c s·ªë r·∫•t l·ªõn, v√¨ v·∫≠y h√£y s·ª≠ d·ª•ng `BigInt` trong l·∫≠p tr√¨nh th·ª±c t·∫ø.</p>
            
            <div class="mb-4">
                <label for="example-loader" class="block text-sm font-medium text-gray-700">T·∫£i v√≠ d·ª• t·ª´ b√†i t·∫≠p:</label>
                <select id="example-loader" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                    <option value="none">-- Ch·ªçn m·ªôt b√†i t·∫≠p --</option>
                    <option value="ex1">B√†i 1 & 2: M√£ h√≥a/Gi·∫£i m√£ "STOP"</option>
                    <option value="ex3">B√†i 3: Gi·∫£i m√£ "0981 0461"</option>
                    <option value="ex4">B√†i 4: T·∫°o kh√≥a v·ªõi p=97, q=173</option>
                    <option value="ex5">B√†i 5: T√¨m th√¥ng ƒëi·ªáp g·ªëc</option>
                </select>
            </div>
            
            <div class="space-y-8">
                <div class="flex">
                    <div class="step-indicator">1</div>
                    <div>
                        <h3 class="mt-0">T·∫°o Kh√≥a</h3>
                        <p class="text-sm text-gray-500 mb-4">B·∫Øt ƒë·∫ßu b·∫±ng c√°ch ch·ªçn hai s·ªë nguy√™n t·ªë `p` v√† `q` ƒë·ªÉ t·∫°o kh√≥a c√¥ng khai v√† kh√≥a ri√™ng t∆∞.</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pl-14">
                    <div>
                        <label class="font-semibold">Nh·∫≠p p:</label>
                        <input id="sim_p" type="text" class="input-field mt-1" placeholder="S·ªë nguy√™n t·ªë p">
                    </div>
                    <div>
                        <label class="font-semibold">Nh·∫≠p q:</label>
                        <input id="sim_q" type="text" class="input-field mt-1" placeholder="S·ªë nguy√™n t·ªë q">
                    </div>
                </div>
                <div class="pl-14">
                    <button id="sim_calc_n_phi" class="btn btn-primary">T√≠nh n v√† œÜ(n)</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pl-14">
                    <div>
                        <label class="font-semibold">n = p * q:</label>
                        <div id="sim_n_result" class="output-box mt-1"></div>
                    </div>
                    <div>
                        <label class="font-semibold">œÜ(n) = (p-1)*(q-1):</label>
                        <div id="sim_phi_result" class="output-box mt-1"></div>
                    </div>
                </div>
                 <div class="pl-14">
                    <label class="font-semibold">Nh·∫≠p s·ªë m≈© c√¥ng khai e:</label>
                    <input id="sim_e" type="text" class="input-field mt-1" placeholder="1 < e < œÜ(n) v√† gcd(e, œÜ(n)) = 1">
                    <button id="sim_calc_d" class="btn btn-primary mt-4">T√≠nh s·ªë m≈© ri√™ng t∆∞ d</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 pl-14">
                    <div>
                        <label class="font-semibold">üîë Kh√≥a C√¥ng Khai (n, e):</label>
                        <div id="sim_public_key" class="output-box mt-1"></div>
                    </div>
                    <div>
                        <label class="font-semibold">üîê Kh√≥a Ri√™ng T∆∞ (n, d):</label>
                        <div id="sim_private_key" class="output-box mt-1"></div>
                    </div>
                </div>


                <hr class="my-8 border-gray-200">

                <div class="flex">
                    <div class="step-indicator">2</div>
                    <div>
                        <h3 class="mt-0">M√£ H√≥a</h3>
                        <p class="text-sm text-gray-500 mb-4">Nh·∫≠p m·ªôt th√¥ng ƒëi·ªáp vƒÉn b·∫£n. N√≥ s·∫Ω ƒë∆∞·ª£c chuy·ªÉn th√†nh c√°c s·ªë (m√£ ASCII) v√† sau ƒë√≥ ƒë∆∞·ª£c m√£ h√≥a b·∫±ng kh√≥a c√¥ng khai `(n, e)`. C√¥ng th·ª©c: `C = M^e mod n`</p>
                    </div>
                </div>
                <div class="pl-14">
                    <label class="font-semibold">Th√¥ng ƒëi·ªáp c·∫ßn m√£ h√≥a:</label>
                    <textarea id="sim_message" class="input-field mt-1" rows="2" placeholder="VD: STOP"></textarea>
                    <button id="sim_encrypt" class="btn btn-primary mt-4">M√£ H√≥a</button>
                </div>
                <div class="pl-14">
                    <label class="font-semibold">Th√¥ng ƒëi·ªáp ƒë√£ m√£ h√≥a (Ciphertext):</label>
                    <div id="sim_ciphertext" class="output-box mt-1"></div>
                </div>

                <hr class="my-8 border-gray-200">

                <div class="flex">
                    <div class="step-indicator">3</div>
                    <div>
                        <h3 class="mt-0">Gi·∫£i M√£</h3>
                        <p class="text-sm text-gray-500 mb-4">B·∫£n m√£ ·ªü tr√™n (ho·∫∑c b·∫•t k·ª≥ b·∫£n m√£ n√†o b·∫°n nh·∫≠p) s·∫Ω ƒë∆∞·ª£c gi·∫£i m√£ b·∫±ng kh√≥a ri√™ng t∆∞ `(n, d)` ƒë·ªÉ kh√¥i ph·ª•c l·∫°i th√¥ng ƒëi·ªáp g·ªëc. C√¥ng th·ª©c: `M = C^d mod n`</p>
                    </div>
                </div>
                <div class="pl-14">
                    <label class="font-semibold">Th√¥ng ƒëi·ªáp c·∫ßn gi·∫£i m√£ (c√°c s·ªë c√°ch nhau b·ªüi d·∫•u c√°ch):</label>
                    <textarea id="sim_ciphertext_input" class="input-field mt-1" rows="2" placeholder="D√°n b·∫£n m√£ v√†o ƒë√¢y"></textarea>
                    <button id="sim_decrypt" class="btn btn-primary mt-4">Gi·∫£i M√£</button>
                </div>
                <div class="pl-14">
                    <label class="font-semibold">Th√¥ng ƒëi·ªáp ƒë√£ gi·∫£i m√£ (Plaintext):</label>
                    <div id="sim_decrypted_message" class="output-box mt-1"></div>
                </div>
            </div>

            <div id="solution_details" class="solution-details hidden">
                </div>
        </section>

        <section id="advanced" class="section-card">
            <h2>üöÄ N√¢ng Cao & B·∫£o M·∫≠t</h2>
            <p class="text-gray-600 mb-6">"RSA s√°ch gi√°o khoa" d·ªÖ b·ªã t·∫•n c√¥ng. Trong th·ª±c t·∫ø, c√°c ph∆∞∆°ng ph√°p b·ªï sung ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l√†m cho n√≥ an to√†n h∆°n v√† hi·ªáu qu·∫£ h∆°n.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3>ƒê·ªám Tin Nh·∫Øn (Padding)</h3>
                    <p class="text-gray-600 mb-4">ƒê·ªÉ ngƒÉn ch·∫∑n c√°c cu·ªôc t·∫•n c√¥ng, tin nh·∫Øn g·ªëc ƒë∆∞·ª£c "ƒë·ªám" b·∫±ng d·ªØ li·ªáu ng·∫´u nhi√™n tr∆∞·ªõc khi m√£ h√≥a. <strong>OAEP</strong> (Optimal Asymmetric Encryption Padding) l√† ti√™u chu·∫©n hi·ªán ƒë·∫°i.</p>
                    <div class="border rounded-lg p-4 bg-gray-50 text-sm">
                        <div class="font-bold mb-2">Quy tr√¨nh ƒë·ªám OAEP (ƒê∆°n gi·∫£n h√≥a)</div>
                        <div class="flex items-center space-x-2">
                            <div class="p-2 bg-yellow-200 rounded">Tin nh·∫Øn</div>
                            <div>+</div>
                            <div class="p-2 bg-green-200 rounded">D·ªØ li·ªáu ng·∫´u nhi√™n</div>
                            <div>‚Üí</div>
                            <div class="p-2 bg-blue-200 rounded">Kh·ªëi d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ƒë·ªám</div>
                        </div>
                    </div>
                </div>
                <div>
                    <h3>ƒê·ªãnh l√Ω S·ªë d∆∞ Trung Hoa (CRT)</h3>
                    <p class="text-gray-600 mb-4">Gi·∫£i m√£ v·ªõi kh√≥a ri√™ng t∆∞ `d` l·ªõn c√≥ th·ªÉ r·∫•t ch·∫≠m. CRT cho ph√©p chia ph√©p t√≠nh gi·∫£i m√£ th√†nh hai ph√©p t√≠nh nh·ªè h∆°n (tr√™n `p` v√† `q`), gi√∫p tƒÉng t·ªëc ƒë·ªô gi·∫£i m√£ l√™n kho·∫£ng 4 l·∫ßn.</p>
                    <div class="border rounded-lg p-4 bg-gray-50 text-sm">
                         <div class="font-bold mb-2">T·ªëi ∆∞u h√≥a gi·∫£i m√£ b·∫±ng CRT</div>
                         <div class="font-mono">
                             <p><span class="text-red-600">Thay v√¨:</span> M = C^d mod (p*q)</p>
                             <p><span class="text-green-600">Th·ª±c hi·ªán:</span></p>
                             <p class="ml-4">1. m1 = C^dp mod p</p>
                             <p class="ml-4">2. m2 = C^dq mod q</p>
                             <p class="ml-4">3. K·∫øt h·ª£p m1, m2 ƒë·ªÉ t√¨m M</p>
                         </div>
                    </div>
                </div>
            </div>
            <h3 class="mt-8">ƒê·ªô d√†i kh√≥a v√† B·∫£o m·∫≠t</h3>
            <p class="text-gray-600 mb-4">S·ª©c m·∫°nh c·ªßa RSA ph·ª• thu·ªôc tr·ª±c ti·∫øp v√†o ƒë·ªô d√†i c·ªßa m√¥-ƒëun `n`. C√°c kh√≥a d√†i h∆°n s·∫Ω an to√†n h∆°n nh∆∞ng c≈©ng t√≠nh to√°n ch·∫≠m h∆°n.</p>
            <div class="chart-container">
                <canvas id="keyLengthChart"></canvas>
            </div>
        </section>

        <section id="applications" class="section-card">
            <h2>üåê ·ª®ng D·ª•ng Th·ª±c T·∫ø</h2>
            <p class="text-gray-600 mb-6">RSA l√† m·ªôt ph·∫ßn kh√¥ng th·ªÉ thi·∫øu trong c∆° s·ªü h·∫° t·∫ßng an ninh m·∫°ng hi·ªán ƒë·∫°i, b·∫£o v·ªá h√†ng t·ª∑ t∆∞∆°ng t√°c k·ªπ thu·∫≠t s·ªë m·ªói ng√†y.</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-gray-50 p-6 rounded-lg text-center">
                    <div class="text-4xl mb-3">üîí</div>
                    <h3 class="mt-0 mb-2">HTTPS & TLS/SSL</h3>
                    <p class="text-sm text-gray-600">B·∫£o v·ªá k·∫øt n·ªëi gi·ªØa tr√¨nh duy·ªát c·ªßa b·∫°n v√† c√°c trang web, ƒë·∫£m b·∫£o d·ªØ li·ªáu duy·ªát web ƒë∆∞·ª£c an to√†n.</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center">
                    <div class="text-4xl mb-3">‚úçÔ∏è</div>
                    <h3 class="mt-0 mb-2">Ch·ªØ K√Ω S·ªë</h3>
                    <p class="text-sm text-gray-600">X√°c th·ª±c ngu·ªìn g·ªëc v√† t√≠nh to√†n v·∫πn c·ªßa t√†i li·ªáu v√† ph·∫ßn m·ªÅm, ƒë·∫£m b·∫£o ch√∫ng kh√¥ng b·ªã gi·∫£ m·∫°o.</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center">
                    <div class="text-4xl mb-3">üìß</div>
                    <h3 class="mt-0 mb-2">Email B·∫£o M·∫≠t</h3>
                    <p class="text-sm text-gray-600">M√£ h√≥a n·ªôi dung email ƒë·ªÉ ch·ªâ ng∆∞·ªùi nh·∫≠n d·ª± ki·∫øn m·ªõi c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c (v√≠ d·ª•: PGP).</p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center">
                    <div class="text-4xl mb-3">üõ°Ô∏è</div>
                    <h3 class="mt-0 mb-2">VPN & SSH</h3>
                    <p class="text-sm text-gray-600">Thi·∫øt l·∫≠p c√°c k√™nh giao ti·∫øp an to√†n ƒë·ªÉ truy c·∫≠p t·ª´ xa v√†o c√°c h·ªá th·ªëng v√† m·∫°ng m√°y t√≠nh.</p>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="text-center py-6 border-t border-gray-200 mt-8">
        <p class="text-sm text-gray-500">ƒê∆∞·ª£c t·∫°o ra ƒë·ªÉ minh h·ªça c√°c nguy√™n t·∫Øc c·ªßa thu·∫≠t to√°n RSA.</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const getEl = (id) => document.getElementById(id);

    function displayError(element, message) {
        element.textContent = message;
        element.classList.add('text-red-600');
    }

    function displayResult(element, result) {
        element.textContent = result;
        element.classList.remove('text-red-600');
    }

    function gcd(a, b) {
        return b === 0n ? a : gcd(b, a % b);
    }

    function extendedGcd(a, b) {
        if (a === 0n) {
            return [b, 0n, 1n];
        }
        const [g, x1, y1] = extendedGcd(b % a, a);
        const x = y1 - (b / a) * x1;
        const y = x1;
        return [g, x, y];
    }

    function modInverse(e, phi) {
        const [g, x] = extendedGcd(e, phi);
        if (g !== 1n) {
            return null;
        }
        return (x % phi + phi) % phi;
    }

    function power(base, exp, mod) {
        let res = 1n;
        base = base % mod;
        while (exp > 0n) {
            if (exp % 2n === 1n) res = (res * base) % mod;
            exp = exp >> 1n;
            base = (base * base) % mod;
        }
        return res;
    }

    function textToAscii(text) {
        return text.split('').map(char => char.charCodeAt(0).toString());
    }

    function asciiToText(asciiArray) {
        return asciiArray.map(code => String.fromCharCode(Number(code))).join('');
    }

    getEl('calc_phi').addEventListener('click', () => {
        try {
            const p = BigInt(getEl('phi_p').value);
            const q = BigInt(getEl('phi_q').value);
            const phi = (p - 1n) * (q - 1n);
            displayResult(getEl('phi_result'), phi.toString());
        } catch (e) {
            displayError(getEl('phi_result'), 'Vui l√≤ng nh·∫≠p s·ªë h·ª£p l·ªá.');
        }
    });

    getEl('calc_mod_inv').addEventListener('click', () => {
        try {
            const e = BigInt(getEl('mod_inv_e').value);
            const phi = BigInt(getEl('mod_inv_phi').value);
            const d = modInverse(e, phi);
            if (d !== null) {
                displayResult(getEl('mod_inv_result'), d.toString());
            } else {
                displayError(getEl('mod_inv_result'), 'Kh√¥ng t·ªìn t·∫°i ngh·ªãch ƒë·∫£o.');
            }
        } catch (e) {
            displayError(getEl('mod_inv_result'), 'Vui l√≤ng nh·∫≠p s·ªë h·ª£p l·ªá.');
        }
    });

    let simState = {};

    getEl('sim_calc_n_phi').addEventListener('click', () => {
        try {
            const p = BigInt(getEl('sim_p').value);
            const q = BigInt(getEl('sim_q').value);
            simState.p = p;
            simState.q = q;
            simState.n = p * q;
            simState.phi = (p - 1n) * (q - 1n);
            displayResult(getEl('sim_n_result'), simState.n.toString());
            displayResult(getEl('sim_phi_result'), simState.phi.toString());
        } catch (e) {
            displayError(getEl('sim_n_result'), 'L·ªói');
            displayError(getEl('sim_phi_result'), 'L·ªói');
        }
    });

    getEl('sim_calc_d').addEventListener('click', () => {
        try {
            const e = BigInt(getEl('sim_e').value);
            if (e <= 1n || e >= simState.phi) {
                displayError(getEl('sim_private_key'), 'e ph·∫£i th·ªèa m√£n 1 < e < œÜ(n)');
                return;
            }
            if (gcd(e, simState.phi) !== 1n) {
                displayError(getEl('sim_private_key'), 'e v√† œÜ(n) ph·∫£i nguy√™n t·ªë c√πng nhau.');
                return;
            }
            simState.e = e;
            simState.d = modInverse(e, simState.phi);
            displayResult(getEl('sim_public_key'), `(${simState.n}, ${simState.e})`);
            displayResult(getEl('sim_private_key'), `(${simState.n}, ${simState.d})`);
        } catch (e) {
            displayError(getEl('sim_private_key'), 'L·ªói! H√£y ch·∫Øc ch·∫Øn ƒë√£ t√≠nh n v√† œÜ(n) tr∆∞·ªõc.');
        }
    });

    getEl('sim_encrypt').addEventListener('click', () => {
        try {
            const message = getEl('sim_message').value;
            const asciiMessage = textToAscii(message);
            const encryptedMessage = asciiMessage.map(m => {
                const M = BigInt(m);
                if (M >= simState.n) {
                    throw new Error(`Gi√° tr·ªã ASCII ${M} l·ªõn h∆°n ho·∫∑c b·∫±ng n. Tin nh·∫Øn qu√° l·ªõn cho kh√≥a n√†y.`);
                }
                return power(M, simState.e, simState.n).toString().padStart(4, '0');
            });
            const ciphertext = encryptedMessage.join(' ');
            displayResult(getEl('sim_ciphertext'), ciphertext);
            getEl('sim_ciphertext_input').value = ciphertext;
        } catch (e) {
            displayError(getEl('sim_ciphertext'), 'L·ªói m√£ h√≥a: ' + e.message);
        }
    });

    getEl('sim_decrypt').addEventListener('click', () => {
        try {
            const ciphertext = getEl('sim_ciphertext_input').value;
            const encryptedBlocks = ciphertext.split(' ').filter(b => b);
            const decryptedAscii = encryptedBlocks.map(c => {
                const C = BigInt(c);
                return power(C, simState.d, simState.n).toString();
            });
            const decryptedMessage = asciiToText(decryptedAscii);
            displayResult(getEl('sim_decrypted_message'), decryptedMessage);
        } catch (e) {
            displayError(getEl('sim_decrypted_message'), 'L·ªói gi·∫£i m√£. Ki·ªÉm tra l·∫°i c√°c kh√≥a v√† b·∫£n m√£.');
        }
    });

    const examples = {
        ex1: {
            p: '43', q: '59', e: '13', msg: 'STOP', ciph: '2081 0090 0461 0981', d_known: '937',
            solutionText: `
                <h3>Gi·∫£i B√†i 1 & 2: M√£ h√≥a/Gi·∫£i m√£ "STOP"</h3>
                <h4>B√†i 1: M√£ h√≥a th√¥ng ƒëi·ªáp STOP</h4>
                <p><strong>1. T·∫°o Kh√≥a (d·ª±a tr√™n p=43, q=59, e=13):</strong></p>
                <ul>
                    <li>T√≠nh n = p * q = 43 * 59 = 2537.</li>
                    <li>T√≠nh Œ¶(n) = (p - 1) * (q - 1) = (43 - 1) * (59 - 1) = 42 * 58 = 2436.</li>
                    <li>e = 13 (h·ª£p l·ªá v√¨ gcd(13, 2436) = 1).</li>
                    <li>T√≠nh d sao cho (d * 13) ‚â° 1 mod 2436. S·ª≠ d·ª•ng Thu·∫≠t to√°n Euclid m·ªü r·ªông, ta t√¨m ƒë∆∞·ª£c d = 937.</li>
                    <li>Kh√≥a c√¥ng khai: (n=2537, e=13). Kh√≥a ri√™ng t∆∞: (n=2537, d=937).</li>
                </ul>
                <p><strong>2. Chuy·ªÉn ƒë·ªïi th√¥ng ƒëi·ªáp "STOP" sang s·ªë (ASCII):</strong></p>
                <ul>
                    <li>S = 83</li>
                    <li>T = 84</li>
                    <li>O = 79</li>
                    <li>P = 80</li>
                </ul>
                <p><strong>3. M√£ h√≥a t·ª´ng k√Ω t·ª± (C = M^e mod n):</strong></p>
                <ul>
                    <li>S (M=83): C_S = 83^13 mod 2537 = 2081</li>
                    <li>T (M=84): C_T = 84^13 mod 2537 = 0090</li>
                    <li>O (M=79): C_O = 79^13 mod 2537 = 0461</li>
                    <li>P (M=80): C_P = 80^13 mod 2537 = 0981</li>
                </ul>
                <p>Th√¥ng ƒëi·ªáp m√£ h√≥a thu ƒë∆∞·ª£c l√†: <strong>2081 0090 0461 0981</strong>.</p>

                <h4>B√†i 2: Gi·∫£i m√£ th√¥ng ƒëi·ªáp m√£ h√≥a thu ƒë∆∞·ª£c ·ªü c√¢u (1) s·ª≠ d·ª•ng d=937.</h4>
                <p><strong>1. Ph√¢n t√≠ch ƒë·∫ßu v√†o:</strong></p>
                <ul>
                    <li>Th√¥ng ƒëi·ªáp m√£ h√≥a: 2081 0090 0461 0981.</li>
                    <li>M√¥ ƒëun n = 2537.</li>
                    <li>S·ªë m≈© gi·∫£i m√£ d = 937.</li>
                </ul>
                <p><strong>2. Gi·∫£i m√£ t·ª´ng kh·ªëi (M = C^d mod n):</strong></p>
                <ul>
                    <li>Gi·∫£i m√£ 2081: M_S = 2081^937 mod 2537 = 83 (ASCII c·ªßa 'S')</li>
                    <li>Gi·∫£i m√£ 0090: M_T = 0090^937 mod 2537 = 84 (ASCII c·ªßa 'T')</li>
                    <li>Gi·∫£i m√£ 0461: M_O = 0461^937 mod 2537 = 79 (ASCII c·ªßa 'O')</li>
                    <li>Gi·∫£i m√£ 0981: M_P = 0981^937 mod 2537 = 80 (ASCII c·ªßa 'P')</li>
                </ul>
                <p>Th√¥ng ƒëi·ªáp gi·∫£i m√£ ƒë∆∞·ª£c l√†: <strong>83 84 79 80</strong>, t∆∞∆°ng ·ª©ng v·ªõi "STOP".</p>
            `
        },
        ex3: {
            p: '43', q: '59', e: '13', msg: '', ciph: '0981 0461', d_known: '937',
            solutionText: `
                <h3>Gi·∫£i B√†i 3: Gi·∫£i m√£ th√¥ng ƒëi·ªáp m√£ h√≥a 0981 0461</h3>
                <p><strong>1. Ph√¢n t√≠ch ƒë·∫ßu v√†o:</strong></p>
                <ul>
                    <li>B·ªô kh√≥a: n = 2537, d = 937 (ƒë∆∞·ª£c x√°c ƒë·ªãnh t·ª´ B√†i 1 & 2).</li>
                    <li>Th√¥ng ƒëi·ªáp m√£ h√≥a: 0981 0461.</li>
                </ul>
                <p><strong>2. Gi·∫£i m√£ t·ª´ng kh·ªëi (M = C^d mod n):</strong></p>
                <ul>
                    <li>Gi·∫£i m√£ 0981: M_1 = 0981^937 mod 2537 = 80 (ASCII c·ªßa 'P')</li>
                    <li>Gi·∫£i m√£ 0461: M_2 = 0461^937 mod 2537 = 79 (ASCII c·ªßa 'O')</li>
                </ul>
                <p>Th√¥ng ƒëi·ªáp gi·∫£i m√£ ƒë∆∞·ª£c l√†: <strong>80 79</strong>, t∆∞∆°ng ·ª©ng v·ªõi "PO".</p>
            `
        },
        ex4: {
            p: '97', q: '173', e: '5', msg: '', ciph: '',
            solutionText: `
                <h3>Gi·∫£i B√†i 4: T·∫°o kh√≥a v·ªõi p=97 v√† q=173, gi√° tr·ªã e=5</h3>
                <p><strong>1. Ph√¢n t√≠ch ƒë·∫ßu v√†o:</strong></p>
                <ul>
                    <li>p = 97</li>
                    <li>q = 173</li>
                    <li>e = 5</li>
                </ul>
                <p><strong>2. T·∫°o Kh√≥a:</strong></p>
                <ul>
                    <li>T√≠nh n = p * q = 97 * 173 = 16781.</li>
                    <li>T√≠nh Œ¶(n) = (p - 1) * (q - 1) = (97 - 1) * (173 - 1) = 96 * 172 = 16512.</li>
                    <li>e = 5 (h·ª£p l·ªá v√¨ gcd(5, 16512) = 1).</li>
                    <li>T√≠nh d sao cho (d * 5) ‚â° 1 mod 16512. S·ª≠ d·ª•ng Thu·∫≠t to√°n Euclid m·ªü r·ªông, ta t√¨m ƒë∆∞·ª£c d = 6605.</li>
                </ul>
                <p>Kh√≥a c√¥ng khai l√†: <strong>(n=16781, e=5)</strong>.</p>
                <p>Kh√≥a ri√™ng t∆∞ l√†: <strong>(n=16781, d=6605)</strong>.</p>
            `
        },
        ex5: {
            p: '97', q: '173', e: '5', msg: '', ciph: '5347', d_known: '6605',
            solutionText: `
                <h3>Gi·∫£i B√†i 5: T√¨m th√¥ng ƒëi·ªáp g·ªëc</h3>
                <p><strong>1. Ph√¢n t√≠ch ƒë·∫ßu v√†o:</strong></p>
                <ul>
                    <li>Kh√≥a c√¥ng khai c·ªßa A: N = 16781, e = 5.</li>
                    <li>Th√¥ng ƒëi·ªáp m√£ h√≥a t·ª´ B: C = 5347.</li>
                    <li>Y√™u c·∫ßu: T√¨m th√¥ng ƒëi·ªáp g·ªëc ban ƒë·∫ßu (M).</li>
                </ul>
                <p><strong>2. X√°c ƒë·ªãnh Kh√≥a Ri√™ng T∆∞ c·ªßa A:</strong></p>
                <ul>
                    <li>T·ª´ B√†i 4, ta c√≥ p = 97, q = 173.</li>
                    <li>Œ¶(n) = (97 - 1) * (173 - 1) = 96 * 172 = 16512.</li>
                    <li>S·ªë m≈© gi·∫£i m√£ d c·ªßa A ƒë√£ ƒë∆∞·ª£c t√≠nh l√† d = 6605 (sao cho (d * 5) ‚â° 1 mod 16512).</li>
                    <li>Kh√≥a ri√™ng t∆∞ c·ªßa A l√† (n=16781, d=6605).</li>
                </ul>
                <p><strong>3. Gi·∫£i m√£ th√¥ng ƒëi·ªáp (M = C^d mod n):</strong></p>
                <ul>
                    <li>M = 5347^6605 mod 16781 = 123.</li>
                </ul>
                <p>Th√¥ng ƒëi·ªáp g·ªëc ban ƒë·∫ßu l√†: <strong>123</strong>.</p>
            `
        }
    };

    getEl('example-loader').addEventListener('change', (event) => {
        const selected = event.target.value;
        const solutionDetails = getEl('solution_details');

        if (selected === 'none') {
            resetSim();
            solutionDetails.classList.add('hidden');
            solutionDetails.innerHTML = '';
            return;
        }
        
        const ex = examples[selected];
        resetSim();

        if (ex.p) getEl('sim_p').value = ex.p;
        if (ex.q) getEl('sim_q').value = ex.q;
        
        getEl('sim_calc_n_phi').click();

        if (ex.e) getEl('sim_e').value = ex.e;
        getEl('sim_calc_d').click();

        if (ex.msg) getEl('sim_message').value = ex.msg;
        if (ex.ciph) {
            getEl('sim_ciphertext_input').value = ex.ciph;
            displayResult(getEl('sim_ciphertext'), ex.ciph);
        }
        if (ex.d_known) { // Override calculated d if provided in exercise
             simState.d = BigInt(ex.d_known);
             displayResult(getEl('sim_private_key'), `(${simState.n}, ${simState.d})`);
        }

        // Display solution details
        if (ex.solutionText) {
            solutionDetails.innerHTML = ex.solutionText;
            solutionDetails.classList.remove('hidden');
        } else {
            solutionDetails.classList.add('hidden');
            solutionDetails.innerHTML = '';
        }
    });
    
    function resetSim() {
        simState = {};
        const ids = ['sim_p', 'sim_q', 'sim_e', 'sim_message', 'sim_ciphertext_input'];
        ids.forEach(id => getEl(id).value = '');
        const out_ids = ['sim_n_result', 'sim_phi_result', 'sim_public_key', 'sim_private_key', 'sim_ciphertext', 'sim_decrypted_message'];
        out_ids.forEach(id => {
            getEl(id).textContent = '';
            getEl(id).classList.remove('text-red-600');
        });
    }

    const ctx = getEl('keyLengthChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['1024-bit', '2048-bit', '4096-bit'],
            datasets: [{
                label: 'M·ª©c ƒë·ªô an to√†n t∆∞∆°ng ƒë·ªëi',
                data: [50, 85, 100],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.5)',
                    'rgba(255, 206, 86, 0.5)',
                    'rgba(75, 192, 192, 0.5)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'M·ª©c ƒë·ªô an to√†n (T∆∞∆°ng ƒë·ªëi)'
                    }
                },
                x: {
                   title: {
                        display: true,
                        text: 'ƒê·ªô d√†i kh√≥a (bits)'
                    } 
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                let status = '';
                                if (context.label === '1024-bit') status = 'Kh√¥ng c√≤n an to√†n';
                                if (context.label === '2048-bit') status = 'An to√†n (Ti√™u chu·∫©n hi·ªán t·∫°i)';
                                if (context.label === '4096-bit') status = 'R·∫•t an to√†n';
                                label = status;
                            }
                            return label;
                        }
                    }
                }
            }
        }
    });

    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('main section');
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                });
            }
        });
    }, { rootMargin: "-50% 0px -50% 0px" });

    sections.forEach(section => observer.observe(section));
});
</script>

</body>
</html>
